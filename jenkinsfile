pipeline {
    agent{
        docker {                                                        //the agent section specifies a Docker agent with the Python 3.9.18 image, and the args option is used to mount the Docker socket. This ensures that the pipeline can interact with the Docker daemon on the host machine.
            image 'python:3.9.18-bullseye'
            args '-v /var/run/docker.sock:/var/run/docker.sock'
        }
    }

    stages {

        stage('Print PATH') {
            steps {
                script {
                    echo "PATH: ${env.PATH}"
                }
            }
        }

        stage('Checkout') {
            steps {
                echo 'Fetching from GitHub..'
                checkout scmGit(branches: [[name: '*/main']], extensions: [], userRemoteConfigs: [[url: 'https://github.com/Ujjwaldotcom/Django-Proj.git']])
            }
        }
        
        stage('Build'){
            steps{
                script{
                    echo 'Building..'
                    url: 'https://github.com/Ujjwaldotcom/Django-Proj.git'
                    def dockerImage = "Smartnotes:1.0"
                    docker.build(dockerImage, "-f dockerfile .")
                }
            }
        }
        
        stage('Deploy'){
            steps{
                echo 'Deploying to container..'
            }
        }
    }
}
